<!doctype html><html lang=fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes,viewport-fit=cover"><title>Apache2 et ssh, mini memo | Blog Iglou.eu</title><meta property="og:title" content="Apache2 et ssh, mini memo | Blog Iglou.eu"><meta property="og:locale" content="fr_fr"><meta name=theme-color content="#dbf3f4"><meta name=author content="Adrien K"><meta name=description content="ğŸ™ˆ Deb ğŸ™‰ me ğŸ™Š Il y a de cela 8mois, j&amp;rsquo;avais entamÃ© la configuration de mon nouveau serveur dÃ©diÃ© sous debian. Il y a peu, j&amp;rsquo;eus besoin de modifications trÃ¨s simples, mais pas moyen de me rappeler comment les effectuer. Profitons en pour realiser un memo qui me servira aussi dans le futur.

 
Compiler Apache A la compilation d&amp;rsquo;apache j&amp;rsquo;ajoute quelques options
./configure -enable-modules=all --with-included-apr --with-mpm=event --enable-rewrite --enable-headers --enable-deflate --enable-fcgidÂ make sudo make install apache2."><meta property="og:type" content="article"><meta property="og:description" content="ğŸ™ˆ Deb ğŸ™‰ me ğŸ™Š Il y a de cela 8mois, j&amp;rsquo;avais entamÃ© la configuration de mon nouveau serveur dÃ©diÃ© sous debian. Il y a peu, j&amp;rsquo;eus besoin de modifications trÃ¨s simples, mais pas moyen de me rappeler comment les effectuer. Profitons en pour realiser un memo qui me servira aussi dans le futur.

 
Compiler Apache A la compilation d&amp;rsquo;apache j&amp;rsquo;ajoute quelques options
./configure -enable-modules=all --with-included-apr --with-mpm=event --enable-rewrite --enable-headers --enable-deflate --enable-fcgidÂ make sudo make install apache2."><meta property="og:publish_date" name=publish_date content="2012-11-14T05:56:00Z"><meta property="article:published_time" content="2012-11-14T05:56:00Z"><meta property="article:modified_time" content="2022-04-03T13:54:16+02:00"><meta property="article:author" content="Adrien K"><meta property="article:tag" content="Serveur memo"><meta property="og:site_name" content="Blog Iglou.eu"><meta property="og:type" content="blog"><link rel=icon href="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Ctext y=%22.9em%22 font-size=%2290%22%3E%F0%9F%92%BE%3C/text%3E%3C/svg%3E"><link rel=canonical href=https://blog.iglou.eu/apache2-et-ssh-mini-memo/><meta property="og:url" content="https://blog.iglou.eu/apache2-et-ssh-mini-memo/"><style>:root{--c-dark:#33331a;--c-light:#dbf3f4;--c-primary:var(--c-light);--c-secondary:var(--c-dark);--ff-monospace:'Roboto Mono', SFMono-Regular, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;--ff-sans-serif:'Roboto', "Segoe UI", "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", sans-serif}pre,code{--c-secondary:var(--c-light);--c-primary:var(--c-dark)}.btn:hover,.btn:focus{--c-primary:var(--c-dark);--c-secondary:var(--c-light)}*,::after,::before{box-sizing:border-box}.link.inherit{color:inherit}.link.important{color:var(--c-primary);border:.1em dotted transparent;padding:.25em .5em;text-decoration:underline double .05em}.link.important:hover,.link.important:focus{border-color:var(--c-primary);text-decoration:underline .1em}.link.svg{line-height:0;text-decoration:none}.link.svg>svg{fill:var(--c-primary);height:2em}.btn{color:var(--c-primary);border:.1em solid;padding:.25em .5em;display:inline-block;text-decoration:none;background-color:var(--c-secondary)}.intext{font-size:inherit;display:inline}.monospace{font-family:var(--ff-monospace)}.capitalize{text-transform:capitalize}.right{text-align:right}.center{text-align:center}.m0{margin:0}.emoji{color:transparent;text-shadow:0 0 0 var(--c-primary)}.hr{margin:1em 0;border:none;border-bottom:.1em solid var(--c-primary)}.infos,.ariane{padding:.25em .5em;font-weight:700}.infos{gap:.5em;display:grid;margin-top:.5em;margin-bottom:.5em;grid-template-columns:1fr auto}.ariane{border:.1em solid var(--c-primary);border-left:none;border-right:none}body{color:var(--c-primary);font-size:1.2rem;line-height:1.4rem;font-family:var(--ff-sans-serif);background-color:var(--c-secondary);max-width:70em;margin:auto}.article h2::after{content:"";display:block;width:60%;height:1px;background-color:var(--c-primary);margin-top:.15em}pre{color:var(--c-primary);padding:1em;overflow:auto;max-height:100vh;background:var(--c-secondary)}code:not([data-lang]){color:var(--c-primary);background:var(--c-secondary);font-family:var(--ff-monospace);border-radius:3px}.site_title{font-size:3em;text-align:center;line-height:initial;text-shadow:0 0 1px var(--c-primary),0 0 1px var(--c-primary)}.article{margin:1em auto;max-width:80rem}.article_content__img{width:30em;color:var(--c-secondary);cursor:pointer;padding:1em;max-width:100%;text-align:center;font-style:italic;font-weight:700;background-color:var(--c-primary)}.article_content__img_src,.article_content__img:focus{width:100%}.article_content__img_src{max-height:50vh;object-fit:contain}.article_content__img:focus .article_content__img_src{max-height:100vh}.article_comm{margin-top:2em}.main.branch{display:grid;line-height:1.5em;grid-template-columns:minmax(25em,2fr)minmax(10em,1fr)}.articles{width:fit-content;margin:auto}.article_link{border:.1em solid var(--c-primary);margin:1em 0;padding:1.5em;max-width:50em;font-weight:700}.article_link__header,.article_link__footer{gap:1em;display:grid}.article_link__header{margin-bottom:1.5em;grid-template-columns:minmax(15rem,1fr)1fr}.article_link__footer{margin-top:2em;grid-template-columns:1fr auto}.article_link__title>.link{line-height:1.25em;text-decoration:underline .1em transparent}.article_link__title>.link:hover,.article_link__title>.link:focus{text-decoration-color:var(--c-primary)}.paginator{font-size:1.25em;text-align:center}.author{color:var(--c-primary);width:fit-content;margin:1em auto;height:fit-content;padding:0 1em 1em;max-width:20em;background-color:var(--c-secondary)}.author_view{border-radius:1em;width:100%}.author_desc__name{margin-bottom:.25em}.author_social{display:flex;justify-content:space-between}@media(max-width:768px){body{font-size:1rem}.site_title{font-size:1.8em}.main.branch{display:block}.author{max-width:initial}.author_view{max-width:20em}.infos{display:block}.infos>span{padding:0 .15em;border-style:solid;border-width:0 0 0 1px}.article_content__img{margin:auto}.article{margin:1em .15em}.article_comm .btn{margin:.25em}}</style></head><body><header><h1 class="site_title monospace"><a href=/ class="link inherit">Blog.Iglou.eu</a></h1><div class="ariane monospace">/&#8239;<a href=/ class="link inherit">Home</a>&#8239;/&#8239;<h2 class="intext capitalize">Apache2 et ssh, mini memo</h2></div><aside class="infos monospace"><span class=infos_by>Par Adrien K</span>
<span class="infos_date right">Le <time class="article_link__date_format text_neon blue" datetime=2012-11-14T05:56:00Z>14 Nov 2012</time>
Â· Maj le <time class="article_link__date_format text_neon blue" datetime=2022-04-03T13:54:16+02:00>03 Apr 2022</time></span>
<span class=infos_time>Lecture 3 minutes</span>
<span class="infos_tags capitalize right"><a class="article_link__tag link important Serveur" href=/tags/Serveur/>Serveur</a>
<a class="article_link__tag link important memo" href=/tags/memo/>memo</a></span></aside></header><main class=main><article class=article><h2 id=-deb--me->ğŸ™ˆ Deb ğŸ™‰ me ğŸ™Š</h2><p>Il y a de cela 8mois, j&rsquo;avais entamÃ© la configuration de mon nouveau serveur dÃ©diÃ© sous debian. Il y a peu, j&rsquo;eus besoin de modifications trÃ¨s simples, mais pas moyen de me rappeler comment les effectuer. Profitons en pour realiser un memo qui me servira aussi dans le futur.</p><p></p><figure class=article_content__img tabindex=0><img src=/images/www.lafermeduweb.net-images-billets-2009-01-debian_topBillet.png alt="Image de presentation" referrerpolicy=no-referrer loading=lazy class=article_content__img_src></figure><p></p><h3 id=compiler-apache>Compiler Apache</h3><p>A la compilation d&rsquo;apache j&rsquo;ajoute quelques options</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./configure -enable-modules<span style=color:#f92672>=</span>all --with-included-apr --with-mpm<span style=color:#f92672>=</span>event --enable-rewrite --enable-headers --enable-deflate --enable-fcgidÂ 
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div><h3 id=apache2conf>apache2.conf</h3><pre tabindex=0><code class=language-conf data-lang=conf>AddHandler fcgid-script .php
FCGIWrapper /usr/lib/cgi-bin/php5 .php
Options ExecCGI
</code></pre><h3 id=dÃ©sactiver-lauto-index>DÃ©sactiver lâ€™auto-index</h3><p>Le dÃ©sactiver de faÃ§ons gÃ©nÃ©ral dans apache2</p><pre tabindex=0><code>sudo a2dismod autoindex
</code></pre><p>&ldquo;a2dismod&rdquo; est la commande pour dÃ©sactiver un mod, pour le rÃ©activer il faut utiliser &ldquo;a2enmod&rdquo;. Il faut ensuite restart apache</p><ul><li>Â /etc/init.d/apache2 restart</li></ul><p>Le dÃ©sactiver dans une racine virtual host.</p><ul><li>nano .htaccess</li><li><em>ajouter</em> Options -Indexes</li></ul><h3 id=sÃ©curiser-ssh>SÃ©curiser ssh</h3><p><strong>Changer le port (par dÃ©faut, port 22)</strong></p><p>On vÃ©rifie si le port que l&rsquo;on veux pour ssh est utilisÃ©, ici le port 4012.</p><ul><li><h1 id=netstat--tulnp--grep-4012>netstat -tulnp | grep 4012</h1></li></ul><p>Puis modifier le port.</p><ul><li><h1 id=nano-etcsshsshd_config>nano /etc/ssh/sshd_config</h1></li></ul><p><strong>ContrÃ´le Des login</strong> s</p><p>On ouvre le fichier de configuration oÃ¹ l&rsquo;on ajouteras les options.</p><ul><li><h1 id=nano-etcsshsshd_config-1>nano /etc/ssh/sshd_config</h1></li></ul><p>Pour limiter les tentatives de connection au user autorisÃ©.</p><ul><li>AllowUsers toto tata</li></ul><p>Desactiver root et n&rsquo;utiliser que &ldquo;su&rdquo; est trÃ¨s important.</p><ul><li>PermitRootLogin no</li></ul><p>Par dÃ©faut &ldquo;PermitEmptyPasswords no&rdquo; et le protocole ssh2 devrait Ãªtres dÃ©fini correctement. Reload de ssh.</p><ul><li><h1 id=etcinitdssh-restart>/etc/init.d/ssh restart</h1></li></ul><h3 id=dÃ©finir-la-page-dindex>DÃ©finir la page d&rsquo;index</h3><p>Il peut arriver que l&rsquo;on ne veuille pas utiliser la traditionnelle page index.* comme accueil par dÃ©faut. Dans ce cas je vous conseil de ne pas modifier ceci directement dans la conf de apache, mais dans un .htaccess a la racine du virtual host ciblÃ©.</p><ul><li>$ nano .htaccess</li><li>DirectoryIndex monindexperso.ty</li></ul><h3 id=gÃ©rer-les-virtual-host>GÃ©rer les virtual host</h3><p>Pour crÃ©er un host, il suffit d&rsquo;un simple fichier de conf dans sites-available. Il existe dÃ©jÃ  un exemple qu&rsquo;il suffit de copier.</p><ul><li><h1 id=cd-etcapache2sites-available>cd /etc/apache2/sites-available</h1></li><li><h1 id=cp-default-monsitedeblabla>cp default monsitedeblabla</h1></li></ul><p>Il n&rsquo;y a plus qu&rsquo;a Ã©diter ce fichier pour notre host, l&rsquo;activer et redÃ©marrer apache.</p><ul><li><h1 id=nano-monsitedeblabla>nano monsitedeblabla</h1></li><li><h1 id=a2ensite-monsitedeblabla>a2ensite monsitedeblabla</h1></li><li><h1 id=apache2ctl-restart>apache2ctl restart</h1></li></ul><p>Le fichier de conf pas dÃ©faut est &ldquo;compliquÃ©&rdquo; pour rien, il est possible d&rsquo;avoir son host en 3lignes (bien qu&rsquo;il manque des options). Pour dÃ©sactiver un site utilisez a2dissite, vous pouvez le supprimer en suite de sites-available ou le garder pour plus tard. Si vous n&rsquo;accÃ©der pas au bon rÃ©pertoire c&rsquo;est la ligne &ldquo;RedirectMatch ^/$ /apache2-default/&rdquo; qui est prÃ©sente dans la conf du host. A commenter ou supprimer &mldr;</p><p>Mettre en place un firewall, ou un script d&rsquo;intrusion n&rsquo;est pas une mauvaise idÃ©e.</p><p><strong>Ã©a, les amis.</strong></p><aside class="article_comm right"><a class="article_comm__email btn inherit right monospace" href="mailto:adrien@iglou.eu?subject=%5BCommentaire%5D+Apache2%20et%20ssh%2c%20mini%20memo&body=Bonjour%20Adrien%2C%0D%0A">M'envoyer un commentaire</a>
Â·
<a class="article_comm__issue btn inherit right monospace" href="https://github.com/IGLOU-EU/blog.iglou.eu/issues/new?title=Erreur:+Apache2%20et%20ssh%2c%20mini%20memo&body=Lien:+https%3a%2f%2fblog.iglou.eu%2fapache2-et-ssh-mini-memo%2f%0A%0AMince+quel+est+mon+erreur+?%0A">Reporter une erreur</a></aside></article></main><footer><hr class=hr><p class="footer monospace center">Site et contenue sous CC0 - Iconographie par Font Awesome - Sans Cookies ni tracking</p></footer></body></html>