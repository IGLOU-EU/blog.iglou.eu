<!doctype html><html lang=fr-fr dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes,viewport-fit=cover"><title>[PHP] $_SESSION = array(), session_unset et session_destroy() | Blog Iglou.eu</title>
<link rel=icon href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48dGV4dCB5PSIuOWVtIiBmb250LXNpemU9IjkwIj7wn5K+PC90ZXh0Pjwvc3ZnPg=="><link rel=canonical href=https://blog.iglou.eu/php-session-array-sessionunset-et/><meta itemprop=name content="[PHP] $_SESSION = array(), session_unset et session_destroy()"><meta itemprop=description content="Cet article est issu d’une importation historique.
Il fut fait sans correcteur orthographique et grammaticale, il est aussi fort probable que des images et liens soient indisponible. Session my PHP Aidant de temps en temps sur des forums ou en IRC, je tombe par moment sur des personnes qui mélangent, confondes et font des mélimélo perso. Mais pas seulement, il arrive que ce soit les “helpers” qui induisent en erreur (et là, c’est le drame) …"><meta itemprop=datePublished content="2015-03-24T18:30:00+00:00"><meta itemprop=dateModified content="2015-03-24T19:59:36+00:00"><meta itemprop=wordCount content="384"><meta itemprop=keywords content="Programmation"><meta property="og:url" content="https://blog.iglou.eu/php-session-array-sessionunset-et/"><meta property="og:site_name" content="Blog Iglou.eu"><meta property="og:title" content="[PHP] $_SESSION = array(), session_unset et session_destroy()"><meta property="og:description" content="Cet article est issu d’une importation historique.
Il fut fait sans correcteur orthographique et grammaticale, il est aussi fort probable que des images et liens soient indisponible. Session my PHP Aidant de temps en temps sur des forums ou en IRC, je tombe par moment sur des personnes qui mélangent, confondes et font des mélimélo perso. Mais pas seulement, il arrive que ce soit les “helpers” qui induisent en erreur (et là, c’est le drame) …"><meta property="og:locale" content="fr_fr"><meta property="og:type" content="article"><meta property="article:published_time" content="2015-03-24T18:30:00+00:00"><meta property="article:modified_time" content="2015-03-24T19:59:36+00:00"><meta property="article:tag" content="Programmation"><link href=https://blog.iglou.eu/index.xml rel=alternate type=application/rss+xml title="Blog Iglou.eu"><link rel=me href=https://mastodon.social/@norihiori><link rel=stylesheet href=/css/style.min.78c4e815273f85832b83071a056f81e93168c6709573f08d27b647c94165fd23.css integrity="sha256-eMToFSc/hYMrgwcaBW+B6TFoxnCVc/CNJ7ZHyUFl/SM=" crossorigin=anonymous></head><body><div class=toggle-widget id=open-left_panel><style>#open-left_panel .toggle-close{display:none}#open-left_panel:target~.content-main .left_panel{display:block;position:fixed;top:0;left:0;right:0;bottom:0;overflow:auto;z-index:10}#open-left_panel:target .toggle-icon-line{background-color:var(--color-wtoggle-line-focus)}#open-left_panel:target .toggle-icon-line.vertical{transform:rotate(360deg)}#open-left_panel:target .toggle-icon-line.horizontal{transform:rotate(180deg)}#open-left_panel:target .toggle-close{display:initial}#open-left_panel:target .toggle-open{display:none}</style><div class=toggle-icon><span class="toggle-icon-line vertical"></span>
<span class="toggle-icon-line horizontal"></span></div><a class="toggle-open toggle-link" title="Ouvrir Left panel" href=#open-left_panel></a><a class="toggle-close toggle-link" title="Fermer Left panel" href=#close-left_panel></a></div><header class=site-header><h1>Blog Iglou.eu</h1><nav class=main-menu><ul><li><a href=/>Accueil</a></li></ul></nav></header><main class=content-main><div class=top_panel><aside class=article-info><span class=date-info>Le <time class=published datetime=2015-03-24T18:30:00Z>24 Mar 2015
</time>· Maj le <time class=editited datetime=2015-03-24T19:59:36Z>24 Mar 2015
</time></span><span class=spacer></span>
<span class=reading-time>1-2 minutes</span></aside></div><div class=left_panel><aside class=sidebar><div class=toc><h2 class=toc-title>Table des Matières</h2><nav id=TableOfContents><ul><li><ul><li><a href=#session-my-php>Session my PHP</a></li></ul></li></ul></nav></div><div class=tags><h2 class=tags-title>Tags</h2><ul class=tags-list><li class=tags-item><a class=tags-link href=https://blog.iglou.eu/tags/programmation/>Programmation</a></li></ul></div></aside></div><div class=right_panel><article class="blog-article markdown"><div class="box warning monospace"><span>Cet article est issu d&rsquo;une importation historique.<br>Il fut fait sans correcteur orthographique et grammaticale, il est aussi fort probable que des images et liens soient indisponible.</span></div><h3 id=session-my-php>Session my PHP</h3><p>Aidant de temps en temps sur des forums ou en IRC, je tombe par moment sur des personnes qui mélangent, confondes et font des mélimélo perso. Mais pas seulement, il arrive que ce soit les &ldquo;helpers&rdquo; qui induisent en erreur (et là, c&rsquo;est le drame) &mldr;</p><p></p><figure class=article-img><a href=/images/php.jpg target=_blank title="Ouvrir l'image dans un onglet"><img src=/images/php.jpg alt="Image de presentation" referrerpolicy=no-referrer loading=lazy class=img-src></a></figure><p></p><p>Dans ce post nous allons parler des sessions avec PHP, et plus particulièrement de leurs destruction.</p><h4 id=croisé-sur-le-net>Croisé sur le net</h4><ol><li>session_unset() ne doit pas étre utilisé car il détruira également la super globale $_SESSION qui deviendra inutilisable.</li><li>On doit utiliser $_SESSION = array() puis session_unset() avant de &ldquo;destroy&rdquo;</li><li>Il est inutile de vider $_SESSION si on fait un session_destroy()</li><li>$_SESSION = array() et session_unset() font exactement la même chose</li></ol><h4 id=alors-que>Alors que</h4><ol><li>Bien sur c&rsquo;est faux. session_unset va entre autre vider $_SESSION, en revanche si l&rsquo;on indique session_unset($_SESSION) on rigole jaune. C&rsquo;est au passage indiqué sur le man de PHP &mldr;</li><li>Encore une idée étrange. Les deux vont faire une chose, c&rsquo;est vider $_SESSION. Alors hors idée perverse d&rsquo;utiliser le double de ressources c&rsquo;est pas utile.</li><li>session_destroy() vas détruire le fichier de session, mais ne vide pas la mémoire. On peut donc toujours accéder aux données.</li><li>C&rsquo;est pas si faux que ça et en vulgarisation c&rsquo;est le cas. La seul différence est que session_unset(), va vérifier si ce qui est passé en arguments correspond bien à une &ldquo;php_session_active&rdquo;.</li></ol><h4 id=exemples-et-sources>Exemples et sources</h4><p>Je vois déjà des &ldquo;c&rsquo;est bien beau, mais comment on peut savoir si toi aussi tu racontes pas des conneries ?&rdquo;<br>Pour le 1er et 2eme points il est simple de vérifier :
<a href=http://php.net/manual/fr/function.session-unset.php class=external-link rel="noreferrer nofollow noopener" target=_blank>http://php.net/manual/fr/function.session-unset.php</a></p><p>Pour le 2eme point on peut tout de même vérifier :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#39;time&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>time</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_unset</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($_SESSION);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$_SESSION <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($_SESSION);
</span></span></code></pre></div><p>Le 3eme points est très simple à tester :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$_SESSION[<span style=color:#e6db74>&#39;time&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>time</span>();
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>$_SESSION;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>session_destroy</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>var_dump</span>($a);
</span></span></code></pre></div><p>Le 4eme points ce trouve dans la
<a href=https://github.com/php/php-src/blob/663074b6b1fa4534fbbb65462aeef40f2c983ad5/ext/session/session.c#L2267 class=external-link rel="noreferrer nofollow noopener" target=_blank>source de php</a>
:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#a6e22e>PHP_FUNCTION</span>(session_unset)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>PS</span>(session_status) <span style=color:#f92672>!=</span> php_session_active)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        RETURN_FALSE;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>IF_SESSION_VARS</span>() 
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        HashTable <span style=color:#f92672>*</span>ht_sess_var <span style=color:#f92672>=</span> <span style=color:#a6e22e>Z_ARRVAL_P</span>(<span style=color:#a6e22e>Z_REFVAL</span>(<span style=color:#a6e22e>PS</span>(http_session_vars)));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/* Clean $_SESSION. */</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>zend_hash_clean</span>(ht_sess_var);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><em>Pour faire le ménage du client <code>_setcookie(session_name(),'',0,'/');</code> ce qui supprime le cookie utilisateur de sa session.</em></p><p><strong>éa, les amis.</strong></p></article></div></main><footer class=site-footer><p>Copyright 2025 CC0 - Sans Cookies ni tracking</p></footer></body></html>